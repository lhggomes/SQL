SELECT
  E.NOME AS EMITENTE,
  TO_CHAR(NFS.NUMNOTA) AS NF,
  NFS.ESPECIE ESPECIE,
  NFS.SERIE SERIE,
  'SAIDA' OPERACAO,
  NFS.DTSAIDA AS DATANF,
  TO_CHAR(NFS.NUMTRANSVENDA) TRANSACAO,
  NFS.CODCLI CLI_FORNEC,
  NFS.FUNCLANC FUNCLANC,
  NFS.HORALANC HORALANC,
  NFS.MINUTOLANC MINLANC,
  NFS.ROTINALANC ROTINALANC,
  NFS.EQUIPLANC MICRO,
  NFS.CHAVENFE CHAVEACESSO
FROM
  PCNFSAID NFS, PCEMPR E
WHERE
  NFS.CODEMITENTE = E.MATRICULA
  AND NFS.NUMNOTA = :NUMNOTA
  AND NFS.NUMTRANSVENDA = :NUMTRANS
UNION ALL
SELECT
  E.NOME AS EMITENTE,
  TO_CHAR(NFE.NUMNOTA) AS NF,
  NFE.ESPECIE ESPECIE,
  NFE.SERIE SERIE,
  'ENTRADA' OPERACAO,
  NFE.DTENT AS DATANF,
  TO_CHAR(NFE.NUMTRANSENT) TRANSACAO,
  NFE.CODFORNEC CLI_FORNEC,
  NFE.FUNCLANC FUNCLANC,
  NFE.HORALANC HORALANC,
  NFE.MINUTOLANC MINLANC,
  NFE.ROTINALANC ROTINALANC,
  NFE.EQUIPLANC MICRO,
  NFE.CHAVENFE CHAVEACESSO
FROM
  PCNFENT NFE, PCEMPR E
WHERE
  NFE.CODFUNCLANC = E.MATRICULA
  AND NFE.NUMNOTA = :NUMNOTA
  AND NFE.NUMTRANSENT = :NUMTRANS
ORDER BY
  2
