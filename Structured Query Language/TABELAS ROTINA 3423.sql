SELECT C.NUMCOTACAO, C.DTCADASTRO AS DATA, I.CODFORNEC,                                                                                                            
  F.FORNECEDOR, DECODE(FC.SITUACAO, 'F', 'APROVADA','PENDENTE') AS SITUACAO,                                                                                       
   I.CODFILIAL AS FILIAL, I.CODPROD, B.DESCRICAO,                                                                                                                  
C.CODFUNCLANC AS COD_FUNC, U.NOME AS FUNCIONARIO_LANCAMENTO,                                                                                                       
P.QTPEDIDA, I.PCOMPRA AS VALOR, P.QTPEDIDA*I.PCOMPRA AS VT_PRODUTO                                                                       
FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U, PCFORNECCOTACAOCIAP FC                                         
WHERE I.CODPROD = B.CODPROD                                                                                                                                        
AND I.CODFORNEC = F.CODFORNEC                                                                                                                                      
AND FC.NUMCOTACAO = C.NUMCOTACAO                                                                                                                                   
AND C.NUMCOTACAO = I.NUMCOTACAO                                                                                                                                    
AND I.NUMCOTACAO = P.NUMCOTACAO                                                                                                                                    
AND I.CODFORNEC = FC.CODFORNEC                                                                                                                                     
AND I.CODPROD = P.CODPROD                                                                                                                                          
AND C.CODFUNCLANC = U.MATRICULA                                                                                                                                    
AND C.NUMCOTACAO = :NUMCOTACAO                                                                                                                                     
AND I.CODFILIAL = :FILIAL                                                                                                                                          
AND C.DTCADASTRO BETWEEN :DTINICIAL AND :DTFINAL                                                                                                                   
--GROUP BY C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, I.PCOMPRA, C.CODFUNCLANC, U.NOME, FC.SITUACAO                
ORDER BY C.NUMCOTACAO

;
TABELAS ROTINA 3423 - COTAÇÃO DE COMPRAS DE CONSUMO 

PCITEMCOTACAOCIAP
PCPRODCOTACAOCIAP

PCCOTACAOCIAP: 



PCFORNEC
PCPRODCIAP
PCPARCELASC
PCFORNECCOTACAOCIAP

 


EDIÇÃO DO SQL 

SELECT  C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, P.QTPEDIDA, I.PCOMPRA, (P.QTPEDIDA * I.PCOMPRA) AS VL_TOTAL_UNITARIO,  C.CODFUNCLANC, U.NOME

FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U
WHERE I.CODPROD = B.CODPROD
AND I.CODFORNEC = F.CODFORNEC
AND C.NUMCOTACAO = I.NUMCOTACAO
AND I.NUMCOTACAO = P.NUMCOTACAO 
AND C.CODFUNCLANC = U.MATRICULA
AND C.NUMCOTACAO = 4
AND I.CODPROD = 881750
ORDER BY I.CODPROD DESC;


SELECT  C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, P.QTPEDIDA, I.PCOMPRA, 
C.CODFUNCLANC, U.NOME,
--(P.QTPEDIDA * I.PCOMPRA) AS VL_TOTAL_UNITARIO 
SUM (P.QTPEDIDA), SUM(I.PCOMPRA)  
FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U
WHERE I.CODPROD = B.CODPROD
AND I.CODFORNEC = F.CODFORNEC
AND C.NUMCOTACAO = I.NUMCOTACAO
AND I.NUMCOTACAO = P.NUMCOTACAO 
AND C.CODFUNCLANC = U.MATRICULA
AND C.NUMCOTACAO = 4
AND I.CODPROD = 881750
GROUP BY I.CODPROD
ORDER BY I.CODPROD


versão 3 

SELECT  C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, P.QTPEDIDA, I.PCOMPRA, (P.QTPEDIDA * I.PCOMPRA) AS VL_TOTAL_UNITARIO,
C.CODFUNCLANC, U.NOME
--SUM (P.QTPEDIDA), SUM(I.PCOMPRA)  
FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U
WHERE I.CODPROD = B.CODPROD
AND I.CODFORNEC = F.CODFORNEC
AND C.NUMCOTACAO = I.NUMCOTACAO
AND I.NUMCOTACAO = P.NUMCOTACAO 
AND C.CODFUNCLANC = U.MATRICULA
AND C.NUMCOTACAO = :NUMCOTACAO

ORDER BY I.CODPROD
	 

FUNCAO SOMA FUNCIONA!!!

SELECT  C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL AS FILIAL, I.CODPROD, B.DESCRICAO, 
SUM (P.QTPEDIDA) AS QUANTIDADE, I.PCOMPRA AS VALOR, (SUM(P.QTPEDIDA) * I.PCOMPRA) AS VT_UNITARIO, C.CODFUNCLANC, U.NOME
FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U
WHERE I.CODPROD = B.CODPROD
AND I.CODFORNEC = F.CODFORNEC
AND C.NUMCOTACAO = I.NUMCOTACAO
AND I.NUMCOTACAO = P.NUMCOTACAO 
AND C.CODFUNCLANC = U.MATRICULA
AND C.NUMCOTACAO = :NUMCOTACAO
AND C.DTCADASTRO BETWEEN :DTINICIAL AND :DTFINAL 
AND I.CODFILIAL = :FILIAL 
GROUP BY C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, I.PCOMPRA, C.CODFUNCLANC, U.NOME 
ORDER BY C.NUMCOTACAO 


SQL VERSAO NUBIA * ISRAEL FINAL 

SELECT  C.NUMCOTACAO, C.DTCADASTRO AS DATA, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL AS FILIAL, I.CODPROD, B.DESCRICAO, 
SUM (P.QTPEDIDA) AS QUANTIDADE, I.PCOMPRA AS VALOR, (SUM(P.QTPEDIDA) * I.PCOMPRA) AS VT_PRODUTO, C.CODFUNCLANC AS COD_FUNC, U.NOME AS FUNCIONARIO
FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U
WHERE I.CODPROD = B.CODPROD
AND I.CODFORNEC = F.CODFORNEC
AND C.NUMCOTACAO = I.NUMCOTACAO
AND I.NUMCOTACAO = P.NUMCOTACAO 
AND C.CODFUNCLANC = U.MATRICULA
AND C.NUMCOTACAO = :NUMCOTACAO
AND C.DTCADASTRO BETWEEN :DTINICIAL AND :DTFINAL 
AND I.CODFILIAL = :FILIAL 
GROUP BY C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, I.PCOMPRA, C.CODFUNCLANC, U.NOME 
ORDER BY C.NUMCOTACAO 
	  


SQL VERSAO FINAL FINAL 

SELECT  C.NUMCOTACAO, C.DTCADASTRO AS DATA, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL AS FILIAL, I.CODPROD, B.DESCRICAO, 
SUM (P.QTPEDIDA) AS QUANTIDADE, I.PCOMPRA AS VALOR, (SUM(P.QTPEDIDA) * I.PCOMPRA) AS VT_PRODUTO, C.CODFUNCLANC AS COD_FUNC, U.NOME AS FUNCIONARIO
FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U
WHERE I.CODPROD = B.CODPROD
AND I.CODFORNEC = F.CODFORNEC
AND C.NUMCOTACAO = I.NUMCOTACAO
AND I.NUMCOTACAO = P.NUMCOTACAO 
AND C.CODFUNCLANC = U.MATRICULA
AND C.NUMCOTACAO = :NUMCOTACAO
AND C.DTCADASTRO BETWEEN :DTINICIAL AND :DTFINAL 
AND I.CODFILIAL = :FILIAL 
GROUP BY C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, I.PCOMPRA, C.CODFUNCLANC, U.NOME 
ORDER BY C.NUMCOTACAO 


SQL VERSAO FINAL FINAL FINAL !!!  

SELECT  C.NUMCOTACAO, C.DTCADASTRO AS DATA, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL AS FILIAL, I.CODPROD, B.DESCRICAO, 
SUM (P.QTPEDIDA) AS QUANTIDADE, I.PCOMPRA AS VALOR, (SUM(P.QTPEDIDA) * I.PCOMPRA) AS VT_PRODUTO, C.CODFUNCLANC AS COD_FUNC, U.NOME AS FUNCIONARIO
FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U
WHERE I.CODPROD = B.CODPROD
AND I.CODFORNEC = F.CODFORNEC
AND C.NUMCOTACAO = I.NUMCOTACAO
AND I.NUMCOTACAO = P.NUMCOTACAO
AND I.CODPROD = P.CODPROD
AND C.CODFUNCLANC = U.MATRICULA
AND C.NUMCOTACAO = :NUMCOTACAO
AND C.DTCADASTRO BETWEEN :DTINICIAL AND :DTFINAL 
AND I.CODFILIAL = :FILIAL 
GROUP BY C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, I.PCOMPRA, C.CODFUNCLANC, U.NOME 
ORDER BY C.NUMCOTACAO 


VERSAO MOSTRAR PARA O VANDERSON 

SELECT  C.NUMCOTACAO, C.DTCADASTRO AS DATA, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL AS FILIAL, I.CODPROD, B.DESCRICAO, 
SUM (P.QTPEDIDA) AS QUANTIDADE, I.PCOMPRA AS VALOR, (SUM(P.QTPEDIDA) * I.PCOMPRA) AS VT_PRODUTO, C.CODFUNCLANC AS COD_FUNC, U.NOME AS FUNCIONARIO
FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U
WHERE I.CODPROD = B.CODPROD
AND I.CODFORNEC = F.CODFORNEC
AND C.NUMCOTACAO = I.NUMCOTACAO
AND I.NUMCOTACAO = P.NUMCOTACAO
AND I.CODPROD = P.CODPROD
AND C.CODFUNCLANC = U.MATRICULA
AND C.NUMCOTACAO = :NUMCOTACAO
AND I.CODFILIAL = :FILIAL 
AND C.DTCADASTRO BETWEEN :DTINICIAL AND :DTFINAL 
GROUP BY C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, I.PCOMPRA, C.CODFUNCLANC, U.NOME 
ORDER BY C.NUMCOTACAO

MOSTRA ESSE PRO VANDERSON.... 


SELECT  C.NUMCOTACAO, C.DTCADASTRO AS DATA, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL AS FILIAL, I.CODPROD, B.DESCRICAO, 
SUM (P.QTPEDIDA) AS QUANTIDADE, I.PCOMPRA AS VALOR, (SUM(P.QTPEDIDA) * I.PCOMPRA) AS VT_PRODUTO, C.CODFUNCLANC AS COD_FUNC, U.NOME AS FUNCIONARIO_LANCAMENTO
FROM PCCOTACAOCIAP C, PCITEMCOTACAOCIAP I, PCFORNEC F, PCPRODCIAP B, PCPRODCOTACAOCIAP P, PCEMPR U
WHERE I.CODPROD = B.CODPROD
AND I.CODFORNEC = F.CODFORNEC
AND C.NUMCOTACAO = I.NUMCOTACAO
AND I.NUMCOTACAO = P.NUMCOTACAO
AND I.CODPROD = P.CODPROD
AND C.CODFUNCLANC = U.MATRICULA
AND C.NUMCOTACAO = :NUMCOTACAO
AND I.CODFILIAL = :FILIAL 
AND C.DTCADASTRO BETWEEN :DTINICIAL AND :DTFINAL 
GROUP BY C.NUMCOTACAO, C.DTCADASTRO, I.CODFORNEC,  F.FORNECEDOR, I.CODFILIAL, I.CODPROD, B.DESCRICAO, I.PCOMPRA, C.CODFUNCLANC, U.NOME 
ORDER BY C.NUMCOTACAO  
