SELECT NFE.CHAVENFE, NFE.NUMNOTA, NFE.DTENT , NFE.DTEMISSAO, NFE.FORNECEDOR, NFE.CGC, NFE.IE, LIVRO.CODFISCAL, NFE.VLPIS, NFE.VLCOFINS,
REPLACE ((REPLACE ((REPLACE (NFE.CGC, '.', '')), '-', '')), '/', '')  AS CNPJ
FROM PCNFENT NFE, PCNFBASEENT LIVRO
WHERE LIVRO.CODFILIALNF = NFE.CODFILIALNF
AND NFE.DTENT = LIVRO.DTENTRADA
AND NFE.NUMNOTA = LIVRO.NUMNOTA
AND LIVRO.CODFISCAL IN (1411,1202)
AND NFE.DTENT BETWEEN :DTINICIAL AND :DTFINAL
AND GERANFDEVCLI <> 'S'
AND NFE.CODFILIAL = NVL(:FILIAL, 0)
AND NFE.MODELO = '55'
ORDER BY NFE.DTENT; 


NOVA VERSAO DO SQL 

SELECT NFE.NUMNOTA, NFE.DTENT , NFE.DTEMISSAO, NFE.FORNECEDOR, NFE.CGC, NFE.IE, LIVRO.CODFISCAL, NFE.VLPIS, NFE.VLCOFINS,
REPLACE ((REPLACE ((REPLACE (NFE.CGC, '.', '')), '-', '')), '/', '')  AS CNPJ
FROM PCNFENT NFE, PCNFBASEENT LIVRO
WHERE LIVRO.CODFILIALNF = NFE.CODFILIALNF
AND NFE.DTENT = LIVRO.DTENTRADA
AND NFE.NUMNOTA = LIVRO.NUMNOTA
AND LIVRO.CODFISCAL: CFOP
AND NFE.DTENT BETWEEN :DTINICIAL AND :DTFINAL
AND GERANFDEVCLI <> 'S'
AND NFE.CODFILIAL = NVL(:FILIAL, 0)
AND NFE.MODELO = '55'
ORDER BY NFE.DTENT, LIVRO.CODFISCAL


SELECT 360

SELECT NFE.NUMNOTA, NFE.DTENT , NFE.DTEMISSAO, NFE.FORNECEDOR, NFE.CGC, 
REPLACE ((REPLACE ((REPLACE (NFE.CGC, '.', '')), '-', '')), '/', '')  AS CNPJ
FROM PCNFENT NFE
WHERE  NFE.DTENT BETWEEN :DTINICIAL AND :DTFINAL
AND NFE.CODFILIAL = NVL(:FILIAL, 0)
ORDER BY NFE.DTENT

TENTATIVA DE SABADO DE FAZER A SOMA DO SQL 

SELECT N.NUMNOTA, N.DTENT , N.DTEMISSAO, N.FORNECEDOR, N.CGC, N.IE, L.CODFISCAL, L.VLPIS, L.VLCOFINS,
REPLACE ((REPLACE ((REPLACE (N.CGC, '.', '')), '-', '')), '/', '')  AS CNPJ, 
SUM(NVL(N.VLPIS, 0))
--SUM (NFE.VLCOFINS) AS VALOR_COFINS 
FROM PCNFENT N, PCNFBASEENT L
WHERE L.CODFILIALNF = N.CODFILIALNF
AND N.DTENT = L.DTENTRADA
AND N.NUMNOTA = L.NUMNOTA
--AND LIVRO.CODFISCAL: CFOP
AND N.DTENT BETWEEN :DTINICIAL AND :DTFINAL
AND GERANFDEVCLI <> 'S'
AND N.CODFILIAL = NVL(:FILIAL, 0)
AND N.MODELO = '55'
AND N.NUMNOTA = 4955
GROUP BY N.NUMNOTA, L.NUMNOTA




SQL VERSAO ROTINA 800

SELECT  N.NUMNOTA, N.DTENT , N.DTEMISSAO, N.FORNECEDOR, N.CGC, N.IE, L.CODFISCAL, N.VLPIS, N.VLCOFINS,
--N.CHAVENFE,
REPLACE ((REPLACE ((REPLACE (N.CGC, '.', '')), '-', '')), '/', '')  AS CNPJ
FROM PCNFENT N, PCNFBASEENT L
WHERE L.CODFILIALNF = N.CODFILIALNF
AND N.DTENT = L.DTENTRADA
AND N.NUMNOTA = L.NUMNOTA
AND L.CODFISCAL = :CFOP
AND N.DTENT BETWEEN :DTINICIAL AND :DTFINAL
AND GERANFDEVCLI <> 'S'
AND N.CODFILIAL = NVL(:FILIAL, 0)
AND N.MODELO = '55'
ORDER BY N.DTENT; 


SQL VERSAO FINAL COM O CONCATENAR 

SELECT  CONCAT(N.NUMNOTA, (REPLACE ((REPLACE ((REPLACE (N.CGC, '.', '')), '-', '')), '/', ''))) AS VALIDACAO, 
N.NUMNOTA, N.DTENT , N.DTEMISSAO, N.FORNECEDOR, N.CGC,  N.IE, L.CODFISCAL, N.VLPIS, N.VLCOFINS
FROM PCNFENT N, PCNFBASEENT L
WHERE L.CODFILIALNF = N.CODFILIALNF
AND N.DTENT = L.DTENTRADA
AND N.NUMNOTA = L.NUMNOTA
AND L.CODFISCAL = :CFOP
AND N.DTENT BETWEEN :DTINICIAL AND :DTFINAL
AND GERANFDEVCLI <> 'S'
AND N.CODFILIAL = NVL(:FILIAL, 0)
AND N.MODELO = '55'
ORDER BY N.DTENT;,







VERSAO P/ VANDERSON 

SELECT  N.NUMNOTA, N.DTENT , N.DTEMISSAO, N.FORNECEDOR, N.CGC,  N.IE, L.CODFISCAL, SUM(L.VLPIS) AS VLPIS, SUM(L.VLCOFINS) AS VLCOFINS
FROM PCNFENT N, PCNFBASEENT L
WHERE L.CODFILIALNF = N.CODFILIALNF
AND N.DTENT = L.DTENTRADA
AND N.NUMNOTA = L.NUMNOTA
--AND L.CODFISCAL = :CFOP
AND N.DTENT BETWEEN :DTINICIAL AND :DTFINAL
--AND GERANFDEVCLI <> 'S'
AND N.CODFILIAL = NVL(:FILIAL, 0)
AND L.CODFISCAL != 1353
AND L.CODFISCAL != 1360
AND L.CODFISCAL != 2353
AND L.CODFISCAL != 1303
GROUP BY N.NUMNOTA, N.DTENT, N.DTEMISSAO, N.FORNECEDOR, N.CGC, N.IE, L.CODFISCAL 
ORDER BY 1
; 
