ANALITICO POR CONTA / FORNECEDOR

SELECT CP.DTEMISSAO AS DATA, CP.CODCONTA, C.CONTA AS DESPESA, CP.NUMNOTA AS NOTA,  CP.CODFORNEC, F.FORNECEDOR,  CP.HISTORICO, 
-- PEDI PARA AGRUPAR AS NOTAS FISCAIS, POIS PODE HAVER NOTA DESDOBRADA QUE HA VARIOS VALORES, ENTÃO FICA MELHOR SE UNIR
--- UNINDO TAMBÉM ACABA QUE OS VALORES NEGATIVOS DE CANCELAMENTO SE JUNTAM 
SUM (CP.VALOR) AS VALOR    
FROM PCLANC CP, PCFORNEC F, PCCONTA C
WHERE CODFILIAL = :CODFILIAL
AND DTEMISSAO BETWEEN :DATA1 AND :DATA2
AND CP.CODFORNEC = F.CODFORNEC
AND C.CODCONTA = CP.CODCONTA
AND CP.CODCONTA = :CODCONTA
GROUP BY CP.DTEMISSAO, CP.CODCONTA, C.CONTA, CP.NUMNOTA,  CP.CODFORNEC, F.FORNECEDOR,  CP.HISTORICO
ORDER BY 1
;

--- SINTETICO FORNECEDOR / CONTA

SELECT  CP.CODCONTA, C.CONTA AS DESPESA,  CP.CODFORNEC, F.FORNECEDOR, 
-- PEDI PARA AGRUPAR AS NOTAS FISCAIS, POIS PODE HAVER NOTA DESDOBRADA QUE HA VARIOS VALORES, ENTÃO FICA MELHOR SE UNIR
--- UNINDO TAMBÉM ACABA QUE OS VALORES NEGATIVOS DE CANCELAMENTO SE JUNTAM 
SUM (CP.VALOR) AS VALOR    
FROM PCLANC CP, PCFORNEC F, PCCONTA C
WHERE CODFILIAL = :CODFILIAL
AND DTEMISSAO BETWEEN :DATA1 AND :DATA2
AND CP.CODFORNEC = F.CODFORNEC
AND C.CODCONTA = CP.CODCONTA
AND CP.CODCONTA = :CODCONTA
--:CODCONTA SERÁ A CONTA QUE ELE VAI QUERER ANALISAR, ESTAS CONTAS PROVÉM DA PCCONTA E SAO UTLIZADAS NO LANCTOS 
GROUP BY  CP.CODCONTA, C.CONTA,   CP.CODFORNEC, F.FORNECEDOR
ORDER BY 3
;