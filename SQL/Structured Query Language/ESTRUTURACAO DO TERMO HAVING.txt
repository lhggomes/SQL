SELECT N.NUMNOTA, N.CODFILIALNF AS FILIAL, N.DTSAIDA, NF.VLTOTAL AS VALOR_NF,
SUM (N.VLDESDOBRADO) AS TOTAL_BASE,
(SUM(N.VLDESDOBRADO) - NF.VLTOTAL) AS DIFERENCA
FROM PCNFBASESAID N, PCNFSAID NF 
WHERE N.DTSAIDA BETWEEN :DTINICAL AND :DTFINAL 
AND N.NUMNOTA = NF.NUMNOTA
AND NF.NUMTRANSVENDA = N.NUMTRANSVENDA
GROUP BY N.NUMNOTA, N.CODFILIALNF, N.DTSAIDA, NF.VLTOTAL
HAVING (SUM(N.VLDESDOBRADO) - NF.VLTOTAL) <> 0
ORDER BY 6; 